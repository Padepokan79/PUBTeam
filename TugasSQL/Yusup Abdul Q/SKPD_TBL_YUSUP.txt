bY YUSUP ABDUL QOHAR DI SKPD_TBL

//MENCARI PEGAWAI DENGAN GELAR IR
SELECT kdskpd,nmskpd,nmkepala 
FROM skpd_tbl 
where nmkepala like 'ir%';


//MENGHITUNG JULAH PEGAWAI DENGAN GELAR IR
SELECT COUNT(nmkepala) as jumlah_PNS_dengan_Gelar_IR 
FROM skpd_tbl 
where nmkepala like  'ir%' ; 

//MENCARI PEGAWAI YANG JABATAN SEBAGAI KEPALA DINAS 
SELECT kdskpd,nmkepala,jab_kepala 
from skpd_tbl 
where jab_kepala 
like 'kepala dinas%';

//MENCARI PEGAWAI YANG MEMMPUNYAI NAMA BENDAHARA KARNILA
SELECT kdskpd,nmkepala,nmbendahara 
from skpd_tbl 
where nmbendahara ='KARNILA';

//MENAMPILKAN SEMUA DATA DI TABEL SKPD_TBL DENGAN LIMIT 10
SELECT * from skpd_tbl 
limit 0,10;

//MENGUBAH NAMASKPD YANG MEMPUNYAI KDSKPD '001'
Update skpd_tbl 
SET nmskpd = 'SEKRETARIAT DAERAH BENGKULU' 
where kdskpd = '001';

//MENMBAHKAN DATA PEGAWAI
insert into skpd_tbl 
Values ('07','00','050','001','GURU HONORER','Drs.H. ABDUL QOHAR S.KOM','1997050920201209','FITRIANI ANDRIANSYAH','196209171990032006','AGUS BUDI MM','196404091984032034','','','BENGKULU','KEPALA DINAS PERDAGANGAN DAN PENJUALAN','BENDAHARA PENGELUARAN','PEMBUAT DAFTAR GAJI','','','');

//MENAMBAHKAN DATA PEGAWAI
insert into skpd_tbl 
Values ('07','00','051','001','GURU HONORER TAHUNAN','Drs.H. ABDUL ASHAR S.KOM','1997050920201279','FITRIANI ANDRIANSYAH','196209171990032006','AGUS BUDI MM','196404091984032434','','','BENGKULU','KEPALA DINAS PERDAGANGAN DAN PENJUALAN','BENDAHARA PENGELUARAN','PEMBUAT DAFTAR GAJI','','','');

//MENGHAPUS DATA PEGAWAI YANG KDSKPDNYA 051
delete FROM SKPD_TBL 
WHERE KDSKPD='051';


TAMBAHAN TUGAS KEDUA

//MENAMPILKAN JUMLAH PEGAWAI YANG NIPKEPALANYA MEMPUNYAI ANGKA 97
SELECT COUNT(NIPKEPALA) AS jUMLAH_PEGAWAI_YANG_NIPKEPALANYA_MENGANDUNG_ANGKA_97  
FROM SKPD_TBL 
WHERE NIPKEPALA LIKE '%97%';


//MENAMPILKAN JUMLAH PEGAWAI KELAHIRAN 1963
SELECT COUNT(NIPKEPALA) AS JUMLAH_PEGAWAI_DENGAN_TAHUN_LAHIR_1963 
FROM SKPD_TBL 
WHERE NIPKEPALA 
LIKE '1963%';

//MENAMPILKAN NAMA PEGAWAI YANG MEMPUNYAI BENDAHARA LEBIH DARI 1
SELECT ST.NMKEPALA,NIPBENDAHARA,COUNT(ST.NIPBENDAHARA) 
FROM SKPD_TBL ST  
GROUP BY NIPBENDAHARA 
HAVING COUNT(ST.NIPBENDAHARA)>1  

//MENAMPILKAN NAMA PEMBUAT DAFTAR YANG MEMPUNYAI BENDAHARA LEBIH DARI 1
SELECT NMPEMBUATDAFTAR, NIPPEMBUATDAFTAR, COUNT(NMBENDAHARA) AS JUMLAH_BENDAHARA 
FROM SKPD_TBL  
GROUP BY NIPPEMBUATDAFTAR 
HAVING COUNT(NIPBENDAHARA) >1 
ORDER BY NIPPEMBUATDAFTAR ASC ;

//MENAMPILKAN PEGAWAI YANG MEMPUNYAI KDSKPD YANG MENGANDUNG ANGKA 2
SELECT KDSKPD,NMSKPD,NMKEPALA 
FROM SKPD_TBL 
WHERE KDSKPD LIKE '_2_';  


TAMBAH TUGAS KETIGA

//MENAMPILKAN JUMLAH HUTANG,CICILAN HUTANG DAN JUMLAH CICILAN DARI HUTANG KELEBIHAN BAYAR GAJI
SELECT HTBL.NMHUTANG,SUM(H.JMLHUTANG) AS JUMLAH_HUTANG ,SUM(H.JMLCICILAN) as JUMLAH_CICILAN,SUM(H.CICILANAKHIR) AS CICILAN_AKHIR 
FROM HUTANG H 
INNER JOIN HUTANG_TBL HTBL 
ON H.KDHUTANG =HTBL.KDHUTANG 
WHERE HTBL.KDHUTANG ='1';

//MENAMPILKAN NAMA PEGAWAI YANG STATUS KEPEGAWAINYA PENGSIUNAN,DENGAN PANGKAT PEMBINA DAN GAPOK LEBIH DARI 30000000 DAN KURANG DARI 50000000 SERTA MASA KERJA LEBIH DARI 25 BULAN 
SELECT PEG.NAMA,STA.NMSTAPEG,PANG.NMPANGKAT,PEG.GAPOK,PEG.MASKER 
FROM MSTPEGAWAI PEG 
INNER JOIN PANGKAT_TBL PANG 
INNER JOIN STAPEG_TBL STA 
ON PEG.KDPANGKAT =PANG.KDPANGKAT AND PEG.KDSTAPEG = STA.KDSTAPEG 
WHERE PEG.GAPOK > 3000000 AND PEG.GAPOK <50000000 AND PEG.MASKER > '25' AND STA.KDSTAPEG ='23' AND PANG.NMPANGKAT='PEMBINA' AND PEG.NAMA LIKE 'A%'

//MENAMPILKAN PEGAWAI YANG MEMMPUNYAI AGAMA SELAIN ISLAM 
SELECT PEG.NIP,PEG.NAMA,A.NMAGAMA 
FROM MSTPEGAWAI PEG 
INNER JOIN AGAMA_TBL A 
ON PEG.AGAMA =A.KDAGAMA 
WHERE A.KDAGAMA <> '1'

//MENAMPILKAN NAMA PEGAWAI YANG MEMPUNYAI GAOPK TER BESAR DAN MASA KERJA PALING LAMA
SELECT PEG.NAMA,STA.NMSTAPEG,PANG.NMPANGKAT,MAX(PEG.GAPOK),MAX(PEG.MASKER) 
FROM MSTPEGAWAI PEG 
INNER JOIN PANGKAT_TBL PANG 
INNER JOIN STAPEG_TBL STA 
ON PEG.KDPANGKAT =PANG.KDPANGKAT AND PEG.KDSTAPEG = STA.KDSTAPEG

//MENAMPILKAN SEMUA DATA YANG ADA DI TABEL SEBELAH KIRI MESKI TIDAK ADA RELASI DENGAN TABEL YANG SEBELAH KANANNYA
SELECT * FROM AKUNSP2D AK 
LEFT JOIN SKPD_TBL SK 
ON AK.KDSKPD = SK.KDSKPD
 